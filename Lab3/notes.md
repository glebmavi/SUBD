# Вопросы для подготовки к защите

## Вопросы из se.ifmo
- Резервные копии: назначение; локальные и удаленные; полные и инкрементные; холодные и горячие.
- Сравнение подходов SQL Dump, FS Level Backup, Continuous Archiving: применимость, преимущества, недостатки.
- Как рассчитать объем пространства для хранения резервных копий, от чего зависит?
- Как рассчитать требуемую производительность канала для выполнения резервных копий по сети, от чего зависит?
- Какие факторы оказывают влияние на скорость восстановления, почему?

## Дополнительные вопросы

- Какая разница между резервными копиями pg_dump и pg_basebackup?
- В чем заключается отличие восстановления данных после физического сбоя и логической ошибки?
- Как в PostgreSQL можно восстановить базу данных до определенного момента времени?

# Ответы

## Резервные копии: назначение; локальные и удаленные; полные и инкрементные; холодные и горячие.

- Назначение: Резервные копии предназначены для защиты данных от потери в случае сбоев, ошибок или повреждений, обеспечивая возможность восстановления.
- Локальные и удаленные: Локальные резервные копии хранятся на том же сервере или в той же инфраструктуре, а удаленные — на другом сервере или облачном хранилище, повышая надежность данных в случае сбоя оборудования.
- Полные и инкрементные: Полные копии содержат все данные на момент создания, занимая больше места, но проще для восстановления. Инкрементные копии содержат только изменения с момента последней копии, экономят место и снижают нагрузку на систему, но требуют более сложного восстановления.
- Холодные и горячие: Холодные копии выполняются при остановленной базе данных (например, с помощью FS Level Backup) и более надежны, но требуют простоя системы. Горячие копии выполняются при работающей базе (например, с помощью pg_dump или Continuous Archiving), но могут не гарантировать полной согласованности данных.

## Сравнение подходов SQL Dump, FS Level Backup, Continuous Archiving: применимость, преимущества, недостатки.

- SQL Dump:
    - Применимость: Подходит для логических копий, когда требуется сохранить схему и данные.
    - Преимущества: Портативность, независимость от файловой системы, подходит для восстановления отдельных таблиц.
    - Недостатки: Более медленное восстановление и создание по сравнению с файловыми методами, зависит от состояния базы.

- FS Level Backup:
    - Применимость: Подходит для создания полной копии файлов данных при остановленной базе (холодный бэкап).
    - Преимущества: Быстрое восстановление, возможна полная консистентность.
    - Недостатки: Требует простоя базы данных, не подходит для систем с высокой доступностью.

- Continuous Archiving:
    - Применимость: Используется для сохранения всех изменений базы данных путем архивирования WAL.
    - Преимущества: Позволяет точное восстановление данных до любой точки времени.
    - Недостатки: Требует значительного объема хранения для WAL-логов, более сложное управление.

## Как рассчитать объем пространства для хранения резервных копий, от чего зависит?

Объем хранения зависит от:
- Частоты и типа копий (полные или инкрементные): больше копий требуют больше места.
    Объема данных и темпов их изменения: большие и часто изменяющиеся базы данных увеличивают объем.
- Срока хранения: долгий срок хранения требует больше места.

Рассчитывается исходя из среднего размера полной копии и инкрементов за период, умноженного на количество сохраняемых копий и период хранения.

## Как рассчитать требуемую производительность канала для выполнения резервных копий по сети, от чего зависит?

Требуемая пропускная способность рассчитывается по формуле:

    Bandwidth = (размер резервной копии) / (допустимое время для создания копии по сети).

Зависит от:
- Размеров данных для передачи (например, полной копии или WAL-логов).
- Ограничений по времени (временное окно, в которое должна быть выполнена копия).
- Частоты резервного копирования, так как более частые копии требуют большей пропускной способности.

## Какие факторы оказывают влияние на скорость восстановления, почему?

- Размер данных: большие базы данных восстанавливаются дольше.
- Тип резервной копии: полные копии восстанавливаются быстрее, чем инкрементные, так как последние требуют последовательного применения.
- Производительность оборудования: дисковая подсистема, процессор и оперативная память влияют на скорость восстановления.
- Тип восстановления (точка времени или полное восстановление): восстановление до точки времени требует применения всех архивных логов, что увеличивает время.
- Производительность сети: для удаленных копий скорость сети может стать узким местом.

## Какая разница между резервными копиями pg_dump и pg_basebackup?

- pg_dump создает логическую копию, экспортируя данные и структуру. Подходит для переноса и выборочного восстановления.
- pg_basebackup создает физическую копию, копируя все файлы данных. Подходит для полного восстановления и репликации, работает быстрее на больших объёмах.

## В чем заключается отличие восстановления данных после физического сбоя и логической ошибки?

- Физический сбой (например, повреждение диска) требует восстановления файлов данных с последующим восстановлением через WAL.
- Логическая ошибка (например, удаление таблицы) может быть восстановлена через точное восстановление (Point-in-Time Recovery) до момента ошибки.

## Как в PostgreSQL можно восстановить базу данных до определенного момента времени?

Для восстановления базы данных до определенного момента используется Point-in-Time Recovery (PITR). Процесс включает:
- Восстановление базы данных из последней полной резервной копии.
- Применение архивированных WAL до требуемого времени.
